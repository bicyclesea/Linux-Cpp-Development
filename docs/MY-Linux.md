# Linux系统编程

## 1001 Linux系统编程之基础篇01

### 1. (1) 整理ls -l各列的含义 (3) 目录文件的内容是一个什么结构，存储了哪些信息？(2) 什么是硬链接？目录和硬链接存在什么关系？

【答】

（1）**ls -l各列的含义**



（2）**硬链接**



**关系**



（3）**结构**



**信息**



### 2. (1) 检查一下自己的内核版本，在互联网上查询当前最新的内核版本。(2) Linux的系统可以分成哪几层结构，分别有什么功能？

【答】

（1）**自己的内核版本**



**当前最新的内核版本**



（2）**结构**



**功能**



### 3. 以表格的形式整理用户（查询、切换、配置密码、增加和删除）相关命令。

【答】**用户相关命令**



### 4. (1) Linux的虚拟文件系统采用什么类型的数据结构组织的？目录文件和普通文件在数据结构中扮演着怎么样不同的角色？(2) 什么是路径、相对路径和绝对路径？(3) 普通用户家目录在何方？如何快速将当前工作目录切换到家目录。(4) 整理cd命令的几种用法。

【答】

（1）**类型**



**目录文件**



**普通文件**

（2）**路径**

**相对路径**

**绝对路径**



（3）**普通用户家目录**

**方法**

（4）**用法**



### 总结





## 1002 Linux系统编程之基础篇02

### 1. 在/usr/share/doc找到所有以html结尾且大小大于100个block的文件，并且使用ls -l展示其详细信息。

【答】

**文件**



**详细信息**



### 2. 整理学习过的正则表达式规则。

【答】



### 3. 尝试一下vimtutor命令，按照要求练习一下，记录使用到的快捷键。

【答】



### 总结





## 1003 Linux系统编程之基础篇03

### 1. 使用gdb调试程序，整理调试所用到的所有快捷键。使用gdb调试core文件，并检查出错时的堆栈信息。可以使用以下代码进行调试。

```c
#include <stdio.h>
#include <stdlib.h>

typedef struct {
int value;
struct Node *next;
} Node;

// 尾插法插入结点
void add_before_tail(Node **head, int value) {
Node *new_node = (Node *)malloc(sizeof(Node));
new_node->value = value;
new_node->next = NULL;
if (*head == NULL) {
  head = new_node;
} else {
  Node *temp = *head;
  while (temp != NULL) {
      temp = temp->next;
  }
  temp->next = new_node;
}
}

// 打印链表中的所有值
void print_list(Node *head) {
Node *current = head;
while (current != NULL) {
	 current = current->next;
  printf("%d -> ", current->value);
}
printf("NULL\n");
}

int main() {
Node *head = NULL;
add_before_tail(&head, 1);
add_before_tail(&head, 2);
add_before_tail(&head, 3);

print_list(head);
return 0;
}
```

答：



### 2. 说明一下使用动态库和静态库的区别，然后分别生成动态库和静态库。可以直接参考文档笔记中的实现。主要是自己练习一下生成库文件的指令。

答：



### 3. 一个目录中有三个.c文件：main.c add.c subtract.c(内容无所谓)，最终将它们生成一个可执行程序main。请编写这个Makefile文件。一个目录中有三个.c文件：test.c test2.c test3.c(内容无所谓)，它们都有自己的main函数，都要最终生成独立的可执行程序：test、test2、test3。请编写这个Makefile文件。注意：要求实现clean清理和rebuild重建功能。注：可以考虑将你写的Makefile尽量提高通用性。

答：



### 总结





## 1004 Linux系统编程之基础篇04

### 1. 请按照章节《HelloWorld》配置Linux开发环境。配置好公共头文件、Makefile以及.c文件模板。最后实现一个标准C语言的文件流文件复制，将代码提交上来。



### 2. 以下小题目，请利用学过的目录相关操作函数实现：（1）打印列出目录中的所有文件和子目录，要求列出dirent结构体的所有信息（不用递归，只看一级目录）。（2）自己生成一个目录，感受一下telldir和seekdir的使用。（3）往后预习，尝试自己写一下ls -al的实现。



### 总结





## 1005 Linux系统编程之基础篇05

### 1. 实现：（1）无排序功能的ls -al指令（2）实现简化版tree指令


### 总结



## 1006 Linux系统编程之基础篇06

### 1. 请实现fopen/open/mmap三种形式的文件复制。然后自己测试比较一下它们的性能。



### 2. 定义一个学生结构体类型struct student，里边含有学号(int)，姓名，分数(float)。定义结构体数组struct student s[3],给数组赋初值后，写入文件，然后通过lseek偏移到开头，然后再读取并使用printf输出。





### 3. 利用dup实现重定向功能：（1）重定向标准输出到文件（2）标准输入重定向到文件, 从文件读数据（3）实现在标准输出重定向到文件, 复原,再重定向到文件的反复横跳（4）重定向标准错误到文件server.log中, 实现类似打印日志的功能。





### 总结



## 1007 Linux系统编程之文件系统01

### 1. 编写程序A和B。A负责将文件的名字、长度和内容通过管道发送B，B需要新建一个目录，并将该文件存储起来。





### 2. 实现即时聊天，如果对方连续10s没有发送任何消息则断开连接。（注意，即使本方在10s内从标准输入当中输入数据也不行）。



### 总结



## 1008 Linux系统编程之进程管理01

### 1. 说明一下什么是进程，什么是虚拟内存，什么是虚拟CPU？

答：



### 2. 编写C程序验证ps命令显示的是有效用户ID，还是真实用户ID。作业中应该包括代码、操作每个步骤和命令以及最终结果的截图。

答：



### 3. 使用思维导图整理所学过的所有进程相关的命令。

答：



### 4. (1). 请问下面的程序一共输出多少个“-”。(2). 上题中的printf("-")换成printf("-\n")；程序会输出多少个“-”?思考一下为什么？把进程地址空间的图画出来。

```c
int main()
{
  printf("-");
  fork();
  printf("-");
  fork();
  return 0;
}
```

答：



### 总结



## 1009 Linux系统编程之进程管理02

### 1. 说明什么是孤儿进程，什么是僵尸进程，他们对操作系统有什么影响？书写代码创建孤儿进程和僵尸进程。



### 2. 进程的结束方式有哪些？return、_exit和exit有什么区别？



### 3. 实现一个守护进程。



### 4. 书写两个可执行程序：

可执行程序一：

  父进程负责创建子进程并且最后回收其资源；

  子进程加载可执行程序二。

可执行程序二：

  列出当前目录所有文件的文件名。

---

答：



### 5. 验证匿名管道的性质：

1、是否发生读阻塞？

2、是否发生写阻塞？

3、读端先关闭，写端继续写会怎么样？

4、写端先关闭，读端继续读会怎么样？

---

答：



### 总结

- 



## 1010 Linux系统编程之进程管理03

### 1. 新建共享内存，连接，然后往共享内存写入How are you,然后另外一个进程连接共享内存，读取数据并打印显示,最后删除共享内存。 提交操作记录和相关代码。

答：



### 2. fork创建一个子进程，两个进程访问同一段共享内存，共享内存里保存一个整形数，父子进程用for循环的方式。每次对这个整形数字加1，父子进程各循环1000万次。加完后打印一下共享内存里的数字，看看是多少？

答：





### 总结

- 



## 1011 Linux系统编程之进程管理04

### 1. signal的作用是什么？会不会导致阻塞？handler函数会在什么情况下调用？使用同一个handler去注册不同的信号，效果怎么样？

答：



### 2. 信号递送过程中，产生了另一个同类信号会怎么样？产生了另两个、三个、多个同类信号会怎么样？写代码验证一下你的想法。说明mask和pending如何变化。

答：



### 3. 使用sigaction注册2号信号的处理函数。1） 允许自动重启低速系统调用；2）在处理2号信号时阻塞3号信号，不会被3号信号打断；3）在2号信号的信号处理函数中，使用sigpending函数判断一下有没有3号信号处于未决状态。

答：



### 4. 通过sigprocmask阻塞2号信号，睡眠5秒后，解除阻塞，2号信号得到执行；在睡眠后，解除阻塞之前，通过sigpending检测是否有信号挂起。

答：



### 5. 完成窗口聊天：

### （1）通信方式：

\- A进程和B进程负责通信，从标准输入读到的字符串通过管道发给对方
\- A进程从标准输入读到的字符串发给B进程后，B打印到屏幕上。
\- B进程从标准输入读到的字符串发给A进程，A打印到屏幕上。
（2）退出方式：
任意一个进程在标准输入收到输入1，给所有进程（通信双方）发送10号信号，每个进程收到10号信号后，开始执行有序退出。

答：





### 总结

- 



## 1012 Linux系统编程之多线程01

### 1. 什么是线程？线程和进程有哪些区别？

答：



### 2. `pthread_join`为什么需要一个`void **`参数？书写程序，创建3个子线程，然后等待所有的子线程终止，最后获取其退出状态。

答：



### 总结



## 1013 Linux系统编程之多线程02

### 1. 线程的清理函数什么时候会执行？什么情况下线程退出的时候不会执行清理函数？



### 2. 从源码角度说明为什么`pthread_cleanup_push`和`pthread_cleanup_pop`必须成对出现？



### 3. 尝试使用2个线程对同一个全局变量各加2000万(或者更多次)，统计加锁解锁的消耗。使用gettimeofday可以获取高精度当前时间(参考预习文档上对gettimeofday使用说明)。



### 总结



## 1014 Linux系统编程之多线程03

### 1. 现在有两个线程t1和t2，t1 打印 A 和 C，t2 打印 B。书写代码，使用条件变量每次的显示顺序都是A->B->C。代码书写完成后，回答问题：条件变量中加锁的目的是什么？

答：



### 2. 主线程执行事件A，子线程执行事件B，在AB事件之外不使用sleep，使用循环机制配合互斥锁，确保B一定在A完成之后运行。

```c++
A:
  printf("Before A!\n");
  sleep(3)
  printf("After A\n");
B:
  printf("Before B!\n");
  sleep(3)
  printf("After B\n");
```

答：



### 3. 文档上给的生产者消费者代码示例，有时间可以写写练练优化优化。

答：





### 总结

- 



## 1015 Linux系统编程之网络编程01

### 1. OSI模型有哪些层？TCP/IP模型有哪些层？他们之间的对应关系是怎样的？

答：



### 2. TCP/IP协议族常见的协议有哪些？他们分别属于TCP/IP模型的哪一层？

答：



### 3. http的请求方式中: get请求和post请求有什么区别, 试说明

答：



### 总结

- 



## 1016 Linux系统编程之网络编程02

### 1. HTTP请求报文和响应报文由哪些部分组成？HTTP常用方法有哪些？HTTP常用状态码有哪些？



### 2. 对称加密和非对称加密有什么区别？简要说明一下HTTPS的握手阶段流程。



### 3. URI由哪些部分组成？



### 4. HTTP的中文全称是什么？从全称的每个字段来说明HTTP的特点。



### 5. 使用浏览器或者抓包工具, 抓一个http的包, 截图标注一个http请求有那些信息需要重点关注。



### 总结



## 1017 Linux系统编程之网络编程03

### 1. TCP协议如何保证数据的可靠传输？

答：



### 2. 为什么TCP需要三次握手？两次握手为什么不行？

答：



### 3. TCP断开连接时为什么是4次挥手？为什么主动断开的一方要经历TIME_WAIT状态？

答：



### 4. 通过wireshark抓包分析TCP三次握手过程，尝试解读TCP协议的每一个字段，截图显示抓包结果。

答：



### 5. 在net转换的时候, 路由器会做什么事情? 简要说明

答：



### 总结

- 



## 1018 Linux系统编程之网络编程04

### 1. 什么是大端模式和小端模式，什么是主机字节序和网络字节序？编写代码，验证一下自己的机器是大端模式还是小端模式？

答：



### 2. 根据域名，获取一下知名互联网厂商的IP地址信息，如阿里、京东、腾讯、百度。

答：



### 3. 说说socket、bind、listen、connect函数分别有什么作用呢？

答：



### 4. 使用recv和send函数时发生了什么？

答：



### 5. 编写两个程序，一个是客户端另一个是服务端，它们通过tcp连接进行即时聊天。

答：



### 总结





## 1019 Linux系统编程之网络编程05

### 1. 让socket底层基于TCP, 实现代码让两个客户端连接同一个服务端, 两者之间可以相互通信。

答：



### 2. 选做: 让socket底层基于TCP, 实现代码让多个客户端连接同一个服务端, 实现群聊效果(一个人发信息, 别人都可以收到)。

答：



### 总结

- 



## 1020 Linux系统编程之网络编程06

### 1. 边缘触发和水平触发是什么？为什么使用边缘触发的时候必须配合非阻塞IO？

答：



### 2. 把前面写的群聊的代码, 试着改成epoll实现。

答：



### 总结





## 1021 Linux系统编程之网络编程07

### 1. 参考我们上课的代码: 让子进程A打开一个文件, 把这个文件描述符信息发给父进程B, 让父进程B在这个文件上能写一个字符串。



### 2. 仿照我们上课写的进程池, 自己手写(不要直接复制)一个进程池代码 (如果有余力可以试着优化功能)



### 总结





## 1022 Linux系统编程之网络编程08

### 1. 在今天代码的基础上: 实现函数(客户端): recvn(int netfd, void *buf, int length)。该函数可以在不使用MSG_WAITALL的情况下，往buf指向的内存中接收任意长度(length)的数据。即: 把我们的代码由 recv(netFd,buf, len,MSG_WAITALL) 改为调用我们自己实现的 recvn(netfd, buf, length)。

答：





### 2. 选做: 假设服务端有两个文件A.txt, B.txt; 当客户端要求(发送请求)下载A.txt, 服务器传输A.txt给客户端; 当客户端要求下载B.txt的时候, 服务器传输B.txt给客户端

答：





### 总结

- 



## 1023 Linux系统编程之网络编程09

### 1. 上课代码好好看看写写。

答：



### 2. 把我们上课没有写完的队列实现(我们上课只是定义了queue.h, 没有实现queue.c), 写出来(queue.c)。

答：



### 3. 上课说在有序退出的时候, 我们在实现调用sendFd的时候偷懒了, 把sendFd(int local_socket_fd, int net_fd)改造成sendFd(int local_socket_fd, int net_fd, int tag)的模式, 把对应的recvFd也改改。

答：



### 总结

- 



## 1024 Linux系统编程之网络编程10

### 1. 把线程池的代码最好自己手写一遍(如果能自己独立写出来更好)。



### 2. (选作)把我们上课写的线程池的代码选择一个方向进行优化实现(eg: 限制任务队列长度, 队列长度超出的时候, 给用户回复服务器忙.  或者自选优化方向)。



### 3. 把git的今天讲的命令练习一下, 截图提交。



### 总结



## 1025 关系型数据库MySQL01

### 1. 练习今天讲的所有Git命令(提交部分命令的关键截图即可)。

答：



### 2. 模拟和同桌共同使用开发一个项目, 制造冲突, 解决冲突。

答：



### 3. 创建分支, 试着在分支上写代码并且感受合并分支。

答：



### 4. 通过我们在Ubuntu系统中安装的mysql客户端, 创建一个名为'订单'的数据库, 截图提交。

答：



### 总结

- 



## 1026 关系型数据库MySQL02

### 1. 新建如下表 user表，按要求写出如下SQL语句

1. 写出建表语句
2. 增加 年龄这一列
3. 修改身高 为浮点类型
4. 插入10条数据
5. 修改id = 10 的名字为'乔峰'
6. 修改 id 不为1和2 的性别为 '男'

| id   | name   | nickname | gender | height | weight | score | birthday | nation |
| ---- | ------ | -------- | ------ | ------ | ------ | ----- | -------- | ------ |
| int  | String | String   | String | int    | int    | float | Date     | String |
| 编号 | 名字   | 昵称     | 性别   | 身高   | 体重   | 分数  | 生日     | 地区   |

答：



### 2. 有如下一张表

```sql
create table student(
    id int,
    name varchar(20),
    chinese float,
    english float,
    math float
);
```

1. 请添加2列信息，出生日期，籍贯。
2. 请修改语文成绩的数据类型为int型
3. 请在里面插入10名学生数据
4. 假设10名同学中有同姓的，如王，请找出姓王同学的信息
5. 请找出各科不及格学生的信息
6. 请找出有任何一科不及格学生的名称
7. 请找出两科成绩在90分以上的学生名称
8. 请找出没有一科挂科的学生名称

---

答：



### 3. 新建一个学生表S，有包含如下信息

学号 id，
学生姓名 name，
性别 gender，
年龄 age，

专业 dept，

所在系编号 …等

并插入10条数据。

学号格式为 201801 201802 201803...
性别只有 'male' & 'female'
院系包含（信息系、数学系，计算机科学系 等）


然后做如下查询：

-- 1.查询全体学生的学号与姓名。

-- 3.查询全体学生的详细记录。

-- 4.查询全体学生的姓名、出生年份和所属部门 使用列别名改变查询结果的列标题

-- 7.查询所有年龄在20岁以下的学生姓名及其年龄。

-- 8.查询年龄在20~23岁（包括20岁和23岁）之间的学生的姓名、系别和年龄。

-- 9.查询年龄不在20~23岁之间的学生姓名、系别和年龄。

-- 10.查询信息系、数学系和计算机系学生的姓名和性别。

-- 11.查询既不是信息系、数学系，也不是计算机科学系的学生的姓名和性别。

-- 12.查询学号为200518的学生的详细情况。

-- 13.查询所有姓刘学生的姓名、学号和性别。

-- 14.查询姓“李”且全名为两个汉字的学生的姓名。

-- 15.查询名字中第2个字为“立"字的学生的姓名和学号。

-- 16.查询所有不姓刘的学生姓名。

-- 17.查询学号在201801~201809之间的学生姓名。

---

答：



### 4. 创建一个城市表，字段有id、名字、所属国家名字、人口、所属省份，并插入若干数据。

-- 1. 查询所有城市名及人口信息

-- 2. 查询city表中，所有中国的城市信息

-- 3. 查询人口数小于100人城市信息

-- 4. 查询中国,人口数超过500的所有城市信息

-- 5. 查询中国或美国的城市信息

-- 6. 查询人口数为100-200（包括两头）城市信息

-- 7. 查询中国或美国，人口数大于500的城市

-- 8. 查询城市名为qing开头的城市信息

---

答：



### 总结

- 



## 1027 关系型数据库MySQL03

### 1. 新建一个学生表S，有包含如下信息

学号 id，
学生姓名 name，
性别 gender，
年龄 age，

专业 dept，

所在系编号 …等

并插入10条数据。

学号格式为 201801 201802 201803...
性别只有 'male' & 'female'
院系包含（信息系、数学系，计算机科学系 等）


然后做如下查询：

-- 1.查询不同院系学生的人数。
-- 2.查询不同院系学生的平均年龄，并以降序排序。
-- 3.查询计算机系年龄在20岁以下的学生姓名。
-- 4.查询全体学生情况，查询结果按所在系的系号升序排列，同一系中的学生按年龄降序排列。

---

答：



### 2. 创建一个城市表，字段有id、名字、所属国家名字、人口、所属省份，并插入若干数据。

1. 统计city表的行数

2. 统计各国城市的个数

3. 统计每个国家的城市总人口数

4. 统计中国每个省的城市个数及城市名列表

5. 统计每个国家的城市个数,并且只显示超过5个城市的国家

6. 统计每个国家的城市个数,并且只显示超过5个城市的国家并按照从大到小排序

7. 统计每个国家的城市个数,并且只显示超过5个城市的国家并按照从大到小排序,并且只显示排名前三

---

答：



### 3. 某大学研究生院有若干研究生导师，包括职工编号、姓名、职称、研究方向，其中每个导师的职工编号是唯一的。

若干研究生，包括学号、姓名、性别、入学日期，其中每个研究生的学号是唯一的。

每个导师可以带若干研究生，但每个研究生只能有一个导师。

请设计一个数据库，要求可以正确体现导师和研究生之间的关系。

设计完毕之后，请插入一定量的数据，并验证你设计的数据库是否满足要求。

-- 1.请查出每个导师所带研究生的姓名。

-- 2.清查出特定姓名的导师所带研究生的姓名。

-- 3.请查出每个导师所带研究生的数量。

-- 4.请查出每个导师所带的男研究生的数量。

-- 5.请找出选择哪个研究方向的导师最多。

-- 6.请找统计不同职称的导师的个数。

---

答：



### 4. 在数据库中创建如下两张表

```sql
create table dept
(
deptno varchar(10) primary key,
dname varchar(10)
);
create table emp
(
empno varchar(10) primary key,
ename varchar(10),
job varchar(10),
mgr varchar(10),
sal float,
deptno varchar(10) references dept(deptno)
);
insert into dept values ('1','事业部');
insert into dept values ('2','销售部');
insert into dept values ('3','技术部');
insert into emp values ('01','jacky','clerk','tom','1000','1');
insert into emp values ('02','tom','clerk','','2000','1');
insert into emp values ('07','biddy','clerk','','2000','1');
insert into emp values ('03','jenny','sales','pretty','600','2');
insert into emp values ('04','pretty','sales','','800','2');
insert into emp values ('05','buddy','jishu','canndy','1000','3');
insert into emp values ('06','canndy','jishu','','1500','3');
select * from dept;
select * from emp;
```

--1. 列出emp表中各部门的部门号，最高工资，最低工资

--2. 列出emp表中各部门job为'CLERK'的员工的最低工资，最高工资

--3. 对于emp中最低工资小于2000的部门，列出job为'CLERK'的员工的部门号，最低工资，最高工资

--4. 根据部门号由高而低，工资有低而高列出每个员工的姓名，部门号，工资

--5. 列出'buddy'所在部门中每个员工的姓名与部门号

--6. 列出每个员工的姓名，工作，部门号，部门名

--7. 列出emp中工作为'CLERK'的员工的姓名，工作，部门号，部门名

--8. 对于emp中有管理者的员工，列出姓名，管理者姓名（管理者外键为mgr）

--9. 对于dept表中，列出所有部门名，部门号，同时列出各部门工作为'CLERK'的员工名与工作

--10. 对于工资高于本部门平均水平的员工，列出部门号，姓名，工资，按部门号排序

--11. 对于emp，列出各个部门中工资高于本部门平均工资的员工数和部门号，按部门号排序

---

答：



### 总结

- 



## 1028 关系型数据库MySQL04

### 1. 使用c_api向数据库分别实现对数据的: 增删改查。

答：



### 2. 参照我们上课演示的隔离级别: 自己实操演示感知一遍(截图提交: 只要提交部分关键图)。

答：



### 总结

- 























